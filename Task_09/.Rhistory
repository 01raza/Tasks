fractions[i]<- runif(1)
trees[[i]] <- pbtree(b=births[i], d=(fractions[i]*births[i]),n=100)
r[[i]]<- (births[i]- (fractions[i]*births[i]))
}
str(trees)
plot(trees[[5]])
trees[[2]]$tip.label
library(phytools)
trees<-vector("list",1)
births<-c()
fractions<-c()
?pbtree
for(i in 1:100) {
births[i]<- runif(1)
fractions[i]<- runif(1)
trees[[i]] <- pbtree(b=births[i], d=(fractions[i]*births[i]),n=100)
r[[i]]<- (births[i]- (fractions[i]*births[i]))
}
trees<-vector("list",1)
births<-c()
fractions<-c()
r<-c()
?pbtree
for(i in 1:100) {
births[i]<- runif(1)
fractions[i]<- runif(1)
trees[[i]] <- pbtree(b=births[i], d=(fractions[i]*births[i]),n=100)
r[[i]]<- (births[i]- (fractions[i]*births[i]))
}
plot(trees[[5]])
str(trees)
s<-()
?pbtree
for(i in 1:100) {
births[i]<- runif(1)
fractions[i]<- runif(1)
trees[[i]] <- pbtree(b=births[i], d=(fractions[i]*births[i]),n=100)
r[[i]]<- (births[i]- (fractions[i]*births[i]))
s[[i]]<-births[i]
}
str(trees)
s<-c()
?pbtree
for(i in 1:100) {
births[i]<- runif(1)
fractions[i]<- runif(1)
trees[[i]] <- pbtree(b=births[i], d=(fractions[i]*births[i]),n=100)
r[[i]]<- (births[i]- (fractions[i]*births[i]))
s[[i]]<-births[i]
}
?sapply
plot(r, tips)
trees<-vector("list",1)
births<-c()
fractions<-c()
r<-c()
s<-c()
?pbtree
for(i in 1:100) {
births[i]<- runif(1)
fractions[i]<- runif(1)
trees[[i]] <- pbtree(b=births[i], d=(fractions[i]*births[i]),n=100)
r[[i]]<- (births[i]- (fractions[i]*births[i]))
s[[i]]<-births[i]
}
str(trees)
plot(trees[[5]])
trees[[2]]$tip.label
?sapply
### Question 4
tips<-sapply(trees, Ntip)
plot(r, tips)
plot(r, tips)
abline()
?abline
plot(r, tips)
abline(tips, r)
abline(r, tips)
abline(r, tips)
abline(r, tips)
plot(r, tips)
abline(r, tips)
tips
trees[[2]]$tip.label
trees[[1]]$tip.label
trees[[99]]$tip.label
trees[[100]]$tip.label
### Question 5
plot(trees, type="fan")
### Question 5
plot(trees[[5]], type="fan")
tips<-log(sapply(trees, Ntip))
tips
plot(r, tips)
plot(r, tips, xlab= diversification, ylab= log of number of tips)
plot(r, tips, xlab= "diversification, ylab= "log of number of tips")
plot(r, tips, xlab= "diversification", ylab= "log of number of tips")
?plot
plot(r, tips, xlab= "diversification", ylab= "log of number of tips", col="black", pch=16)
plot(r, tips, xlab= "diversification", ylab= "log of number of tips", col="black", pch=21)
plot(r, tips, xlab= "diversification", ylab= "log of number of tips", col="black", pch=13)
plot(r, tips, xlab= "diversification", ylab= "log of number of tips", col="black", pch=9)
plot(r, tips, xlab= "diversification", ylab= "log of number of tips", col="black", pch=15)
plot(r, tips, xlab= "diversification", ylab= "log of number of tips", col="black", pch=16)
plot(r, tips, xlab= "diversification", ylab= "log of number of tips", col="black", pch=17)
plot(r, tips, xlab= "diversification", ylab= "log of number of tips", col="black", pch=18)
plot(r, tips, xlab= "diversification", ylab= "log of number of tips", col="orange", pch=18)
lm(formula = tips ~ r)
abline(lm(tips ~ r))
r
tips
plot(tips,r, xlab= "diversification", ylab= "log of number of tips", col="orange", pch=18)
plot(tips,r, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
abline(lm(tips ~ r))
cor(tips,r)
r1<-unlist(r)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
cor(tips,r1)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
abline(lm(tips ~ r1))
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
abline(lm(tips ~ r1))
lm(tips ~ r1))
lm(tips ~ r1)
abline(3.191, 2.717)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
abline(3.191, 2.717)
s1<-unlist(s)
s1
compute.brlen(trees)
class(trees)
trees$edge.length
trees<-vector("list",1)
births<-c()
fractions<-c()
r<-c()
s<-c()
branch<-c()
?pbtree
for(i in 1:100) {
births[i]<- runif(1)
fractions[i]<- runif(1)
trees[[i]] <- pbtree(b=births[i], d=(fractions[i]*births[i]),n=100)
r[[i]]<- (births[i]- (fractions[i]*births[i]))
s[[i]]<-births[i]
branch[[i]]<-trees[[i]]$edge.length
}
branch
trees<-vector("list",1)
births<-c()
fractions<-c()
r<-c()
s<-c()
branch<-c()
?pbtree
for(i in 1:100) {
births[i]<- runif(1)
fractions[i]<- runif(1)
trees[[i]] <- pbtree(b=births[i], d=(fractions[i]*births[i]),n=100)
r[[i]]<- (births[i]- (fractions[i]*births[i]))
s[[i]]<-births[i]
branch[[i]]<-mean(trees[[i]]$edge.length)
}
branch
plot(branch,s1, xlab="Average branch length" , ylab= "speciaiton rate", col="orange", pch=18)
library(phytools)
trees<-vector("list",1)
births<-c()
fractions<-c()
r<-c()
s<-c()
branch<-c()
?pbtree
for(i in 1:100) {
births[i]<- runif(1)
fractions[i]<- runif(1)
trees[[i]] <- pbtree(b=births[i], d=(fractions[i]*births[i]),n=100)
r[[i]]<- (births[i]- (fractions[i]*births[i]))
s[[i]]<-births[i]
branch[[i]]<-mean(trees[[i]]$edge.length)
}
str(trees)
plot(trees[[5]])
trees[[100]]$tip.label
?sapply
### Question 4
tips<-log(sapply(trees, Ntip))
tips
r1<-unlist(r)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
abline(lm(tips ~ r1))
cor(tips,r1)
### Question 5
s1<-unlist(s)
branch
plot(branch,s1, xlab="Average branch length" , ylab= "speciaiton rate", col="orange", pch=18)
abline(lm(branch ~ s1))
cor(branch,s1)
plot(branch,s1, xlab="Average branch length" , ylab= "speciaiton rate", col="orange", pch=18)
plot(branch,s1, xlab="Average branch length" , ylab= "speciaiton rate", col="orange", pch=1)
branch <-unlist(branch)
abline(lm(branch ~ s1))
cor(branch,s1)
plot(branch,s1, xlab="Average branch length" , ylab= "speciaiton rate", col="orange", pch=1)
sapply(trees, Ntips)
sapply(trees, Ntip)
### Question 7
Tree<-trees[[14]]
plot(Tree)
rates<-c()
traits<-vector("list",1)
rates<-c()
traits<-vector("list",1)
for(i in 1:100) {
rates[i]<- runif(1)
traits[[i]]<-fastBM(tree = Tree, sig2 = rates[i])
}
traits
rates
births
plot(tips,births, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,(births*fractions), xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(mean(traits),rates)
mean(traits)
traits
mean(traits)
class(traits)
traits<-unlist(traits)
class(traits)
traits
mean(traits)
for(i in 1:100) {
rates[i]<- runif(1)
traits[[i]]<-fastBM(tree = Tree, sig2 = rates[i])
traits1[[i]]<-mean(traits[[i]])
}
plot(Tree)
rates<-c()
traits<-vector("list",1)
for(i in 1:100) {
rates[i]<- runif(1)
traits[[i]]<-fastBM(tree = Tree, sig2 = rates[i])
traits1[[i]]<-mean(traits[[i]])
}
traits1<-c()
for(i in 1:100) {
rates[i]<- runif(1)
traits[[i]]<-fastBM(tree = Tree, sig2 = rates[i])
traits1[[i]]<-mean(traits[[i]])
}
traits1
plot(traits1, rates)
rates<-c()
traits<-vector("list",1)
meantraits<-c()
for(i in 1:100) {
rates[i]<- runif(1)
traits[[i]]<-fastBM(tree = Tree, sig2 = rates[i])
meantraits[[i]]<-mean(traits[[i]])
}
plot(mean(traits),rates)
traits<-unlist(traits)
class(traits)
traits1
plot(meantraits, rates)
cor(meantraits, rates)
meantraits<-unlist(meantraits)
cor(meantraits, rates)
plot(meantraits, rates)
rates<-c()
traits<-vector("list",1)
meantraits<-c()
vartraits<-c()
for(i in 1:100) {
rates[i]<- runif(1)
traits[[i]]<-fastBM(tree = Tree, sig2 = rates[i])
meantraits[[i]]<-mean(traits[[i]])
vartraits[[i]]<-var(traits[[i]])
}
plot(mean(traits),rates)
traits<-unlist(traits)
class(traits)
traits1
vartraits<-unlist(meantraits)
plot(vartraits, rates)
cor(vartraits, rates)
cor(traits[[1]], traits[[2]])
### Question 10
cor(traits[1], traits[2])
trait[1]
traits[1]
traits[2]
traitMat<-cbind(traits[[1]], traits[[4]])
traitMat
traitMat<-cbind(traits[[1]], traits[[2]])
traitMat
cor(vartraits, rates)
cor(meantraits, rates)
meantraits<-unlist(meantraits)
cor(meantraits, rates)
vartraits<-unlist(vartraits)
cor(vartraits, rates)
### Question 7
which.max(trees)
### Question 7
which.max(Ntips)
### Question 7
which.max(tips)
Tree<-trees[[which.max(tips)]]
plot(Tree)
rates<-c()
traits<-vector("list",1)
meantraits<-c()
vartraits<-c()
for(i in 1:100) {
rates[i]<- runif(1)
traits[[i]]<-fastBM(tree = Tree, sig2 = rates[i])
meantraits[[i]]<-mean(traits[[i]])
vartraits[[i]]<-var(traits[[i]])
}
plot(mean(traits),rates)
traits<-unlist(traits)
class(traits)
### Question 8
meantraits<-unlist(meantraits)
plot(meantraits, rates)
cor(meantraits, rates)
library(phytools)
### Question 1-3:
setwd('C:\\users\\Raza\\Desktop\\Evolution\\Tasks\\Task_09')
trees<-vector("list",1)
births<-c()
fractions<-c()
r<-c()
s<-c()
branch<-c()
?pbtree
for(i in 1:100) {
births[i]<- runif(1)
fractions[i]<- runif(1)
trees[[i]] <- pbtree(b=births[i], d=(fractions[i]*births[i]),n=100)
r[[i]]<- (births[i]- (fractions[i]*births[i]))
s[[i]]<-births[i]
branch[[i]]<-mean(trees[[i]]$edge.length)
}
str(trees)
plot(trees[[i]])
trees[[100]]$tip.label
?sapply
sapply(trees, Ntip)
tips<-log(sapply(trees, Ntip))
tips
r1<-unlist(r)
pdf("q4_ log tips vs diversification",height=4,width=4)
plot(tips,r, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
plot(trees[[i]])
plot(Tree)
library(phytools)
### Question 1-3:
setwd('C:\\users\\Raza\\Desktop\\Evolution\\Tasks\\Task_09')
trees<-vector("list",1)
births<-c()
fractions<-c()
r<-c()
s<-c()
branch<-c()
?pbtree
for(i in 1:100) {
births[i]<- runif(1)
fractions[i]<- runif(1)
trees[[i]] <- pbtree(b=births[i], d=(fractions[i]*births[i]),n=100)
r[[i]]<- (births[i]- (fractions[i]*births[i]))
s[[i]]<-births[i]
branch[[i]]<-mean(trees[[i]]$edge.length)
}
str(trees)
pdf("q1-3_ i'th tree plot",height=4,width=4)
plot(trees[[i]])
dev.off()
trees[[100]]$tip.label
?sapply
sapply(trees, Ntip)
### Question 4
tips<-log(sapply(trees, Ntip))
tips
r1<-unlist(r)
pdf("q4_ log tips vs diversification",height=4,width=4)
plot(tips,r1, xlab="log of number of tips" , ylab= "diversification", col="orange", pch=18)
abline(lm(tips ~ r1))
dev.off()
cor(tips,r1)
### Question 5
s1<-unlist(s)
branch <-unlist(branch)
pdf("q5_ Avg Branch Length vs speciation rate",height=4,width=4)
plot(branch,s1, xlab="Average branch length" , ylab= "speciaiton rate", col="orange", pch=1)
abline(lm(branch ~ s1))
dev.off()
### Question 6
cor(branch,s1)
### Question 7
Tree<-trees[[which.max(tips)]]
pdf("q7_ largest tree",height=4,width=4)
plot(Tree)
dev.off()
rates<-c()
traits<-vector("list",1)
meantraits<-c()
vartraits<-c()
for(i in 1:100) {
rates[i]<- runif(1)
traits[[i]]<-fastBM(tree = Tree, sig2 = rates[i])
meantraits[[i]]<-mean(traits[[i]])
vartraits[[i]]<-var(traits[[i]])
}
plot(mean(traits),rates)
traits<-unlist(traits)
class(traits)
### Question 8
meantraits<-unlist(meantraits)
pdf("q8_ meantraits vs rates",height=4,width=4)
plot(meantraits, rates)
dev.off()
cor(meantraits, rates)
### Question 9
vartraits<-unlist(vartraits)
pdf("q9_ variance of traits vs rates",height=4,width=4)
plot(vartraits, rates)
dev.off()
cor(vartraits, rates)
### Question 10
cor(traits[1], traits[2])
traits[1]
traits[2]
traitMat<-cbind(traits[[1]], traits[[2]])
?phylomorphospace
phylomorphospace(Tree, traitMat)
for(i in 1:100) {
rates[i]<- runif(1)
traits[[i]]<-fastBM(tree = Tree, sig2 = rates[i])
meantraits[[i]]<-mean(traits[[i]])
vartraits[[i]]<-var(traits[[i]])
}
rates<-c()
traits<-vector("list",1)
meantraits<-c()
vartraits<-c()
for(i in 1:100) {
rates[i]<- runif(1)
traits[[i]]<-fastBM(tree = Tree, sig2 = rates[i])
meantraits[[i]]<-mean(traits[[i]])
vartraits[[i]]<-var(traits[[i]])
}
rates<-c()
traits<-vector("list",1)
meantraits<-c()
vartraits<-c()
for(i in 1:100) {
rates[i]<- runif(1)
traits[[i]]<-fastBM(tree = Tree, sig2 = rates[i])
meantraits[[i]]<-mean(traits[[i]])
vartraits[[i]]<-var(traits[[i]])
}
traitMat<-cbind(traits[[1]], traits[[2]])
### 0.67, indicating a positive relationship
### Question 10
cor(traits[[1]], traits[[2]])
traitMat<-cbind(traits[[1]], traits[[2]])
phylomorphospace(Tree, traitMat)
phylomorphospace(Tree, traitMat, xlab= "trait 1, ylab= "trait 2")
phylomorphospace(Tree, traitMat, xlab= "trait 1", ylab= "trait 2")
phylomorphospace(Tree, traitMat, xlab= "trait 1", ylab= "trait 2")
plot(traits[[1]], traits[[2]])
dev.off()
pdf("Extra Credit",height=4,width=4)
phylomorphospace(Tree, traitMat, xlab= "trait 1", ylab= "trait 2")
dev.off()
pdf("Extra Credit plot",height=20,width=20)
phylomorphospace(Tree, traitMat, xlab= "trait 1", ylab= "trait 2")
dev.off()
### 0.639 positive relation b/w trait 1 and 2
pdf("q10_ trait 1 vs trait 2",height=4,width=4)
plot(traits[[1]], traits[[2]])
dev.off()
install("ids")
library(ids)
Relabel <- adjective_animal(31, max_len=c(10,15))
install(ids)
library(ids)
library(ids)
